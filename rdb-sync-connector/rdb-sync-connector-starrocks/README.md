# RDB Sync - StarRocks è¿æ¥å™¨


## é€‚ç”¨èŒƒå›´
- StarRocksï¼š2.xï¼Œ3.x


## æ¥æº
æš‚æ— æ”¯æŒ...ğŸ˜…


## ç›®æ ‡
### å…ˆå†³æ¡ä»¶
1. ç”¨æˆ·è‡³å°‘å¯¹â€œç›®æ ‡è¡¨â€å…·æœ‰ `Insert`ã€`Update` å’Œ `Delete` æƒé™ã€‚

### ç®¡é“é…ç½®
æ ‡è®° `ğŸ“Œ` è¡¨ç¤ºå…³é”®é…ç½®ï¼Œåœ¨é…ç½®è¡¨ä¸­å…·æœ‰ç‹¬ç«‹çš„å­—æ®µï¼Œå…¶ä½™é…ç½®ä»¥ YAML æ ¼å¼ä¿å­˜åœ¨ `options` å­—æ®µä¸­ã€‚

| é…ç½®                                | ç±»å‹      | é»˜è®¤å€¼                | è¯´æ˜                                                                                                                                                                                                                                                                                                                                                     |
|-----------------------------------|---------|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| id `ğŸ“Œ`                           | String  | _*å¿…å¡«_              | ç®¡é“ç›®æ ‡ID                                                                                                                                                                                                                                                                                                                                                 |
| name `ğŸ“Œ`                         | String  | _*å¿…å¡«_              | ç®¡é“ç›®æ ‡åç§°                                                                                                                                                                                                                                                                                                                                                 |
| protocol `ğŸ“Œ`                     | String  | _*å¿…å¡«_              | ç®¡é“ç›®æ ‡åè®®ï¼Œè®¾ç½®ä¸º `starrocks` ä»¥ä½¿ç”¨æ­¤è¿æ¥å™¨                                                                                                                                                                                                                                                                                                                         |
| hostnames `ğŸ“Œhosts`               | String  | localhost          | FE MySQL æœåŠ¡ä¸»æœºååˆ—è¡¨ <br>ä½¿ç”¨ `;` åˆ†éš”å¤šä¸ªä¸»æœºåã€‚                                                                                                                                                                                                                                                                                                                   |
| ports `ğŸ“Œ`                        | String  | 9030               | FE MySQL æœåŠ¡ç«¯å£åˆ—è¡¨ <br>ä½¿ç”¨ `;` åˆ†éš”å¤šä¸ªç«¯å£ã€‚                                                                                                                                                                                                                                                                                                                     |
| jdbc-url                          | String  |                    | FE MySQL æœåŠ¡çš„è¿æ¥å­—ç¬¦ä¸² <br>æ ¼å¼ç±»ä¼¼äº `jdbc:mysql://fe_ip1:query_port,fe_ip2:query_port...` ã€‚ <br>_æ³¨æ„ï¼šå¦‚æœä½¿ç”¨äº†æ­¤é…ç½®ï¼Œå°†ä¼šè¦†ç›–ä¸Šé¢ä¸¤ä¸ªâ€œç®€åŒ–â€é…ç½®ã€‚_                                                                                                                                                                                                                                  |
| load-hostnames `ğŸ“Œload_hosts`     | String  | localhost          | FE HTTP æœåŠ¡ä¸»æœºåˆ—è¡¨åˆ—è¡¨ <br>ä½¿ç”¨ `;` åˆ†éš”å¤šä¸ªä¸»æœºåã€‚                                                                                                                                                                                                                                                                                                                   |
| load-ports `ğŸ“Œload_ports`         | String  | 8030               | FE HTTP æœåŠ¡ç«¯å£åˆ—è¡¨ <br>ä½¿ç”¨ `;` åˆ†éš”å¤šä¸ªç«¯å£ã€‚                                                                                                                                                                                                                                                                                                                      |
| load-url                          | String  |                    | FE HTTP æœåŠ¡çš„ URL åˆ—è¡¨ <br>æ ¼å¼ç±»ä¼¼äº `fe_ip1:http_port;http://fe_ip2:http_port;https://fe_nlb` ï¼ŒæœªæŒ‡å®š URL å‰ç¼€æ—¶é»˜è®¤ä¸º `http://` ï¼Œè¯·å¤šä¸ª URL ä¹‹é—´ä½¿ç”¨ `;` åˆ†éš”ã€‚ <br>_æ³¨æ„ï¼šå¦‚æœä½¿ç”¨äº†æ­¤é…ç½®ï¼Œå°†ä¼šè¦†ç›–ä¸Šé¢ä¸¤ä¸ªâ€œç®€åŒ–â€é…ç½®ã€‚_                                                                                                                                                                               |
| database-name `ğŸ“Œdatabase`        | String  | _*å¿…å¡«_              | æ•°æ®åº“å                                                                                                                                                                                                                                                                                                                                                   |
| username `ğŸ“Œ`                     | String  | root               | ç”¨æˆ·å                                                                                                                                                                                                                                                                                                                                                    |
| password `ğŸ“Œ`                     | String  |                    | å¯†ç                                                                                                                                                                                                                                                                                                                                                      |
| sink.semantic                     | String  | at-least-once      | è¯­ä¹‰ä¿è¯ <li>`at-least-once`ï¼šä¸€ä¸ªäº‹ä»¶è‡³å°‘åŒæ­¥ä¸€æ¬¡ï¼›<li>`exactly-once`ï¼šä¸€ä¸ªäº‹ä»¶ç²¾ç¡®åŒæ­¥ä¸€æ¬¡ï¼Œå»ºè®®å‡çº§ StarRocks è‡³ 2.5 æˆ–æ›´é«˜ç‰ˆæœ¬åä½¿ç”¨ã€‚                                                                                                                                                                                                                                                       |
| sink.version                      | String  | AUTO               | å¯¼å…¥æ•°æ®çš„æ¥å£ã€‚ <li>`V1`ï¼šä½¿ç”¨ [Stream Load](https://docs.starrocks.io/zh/docs/loading/StreamLoad/) æ¥å£å¯¼å…¥æ•°æ®ï¼› <li>`V2`ï¼šä½¿ç”¨ [Stream Load äº‹åŠ¡æ¥å£](https://docs.starrocks.io/zh/docs/loading/Stream_Load_transaction_interface/)å¯¼å…¥æ•°æ®ã€‚è¦æ±‚ StarRocks ç‰ˆæœ¬å¤§äºç­‰äº 2.4ã€‚å»ºè®®é€‰æ‹© V2ï¼Œå› ä¸ºå…¶é™ä½å†…å­˜ä½¿ç”¨ï¼Œå¹¶æä¾›äº†æ›´ç¨³å®šçš„ exactly-once å®ç°ï¼› <li>`AUTO`ï¼šå¦‚æœ StarRocks ç‰ˆæœ¬æ”¯æŒ Stream Load äº‹åŠ¡æ¥å£ï¼Œå°†è‡ªåŠ¨é€‰æ‹© V2ï¼Œå¦åˆ™é€‰æ‹© V1ã€‚ |
| sink.label-prefix                 | String  |                    | Stream Load çš„æ ‡ç­¾å‰ç¼€ <br>è‹¥è¯­ä¹‰ä¿è¯æ˜¯ `exactly-once` æ—¶ï¼Œå»ºè®®è®¾ç½®æ­¤å€¼ï¼Œå…·ä½“è¯·å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://docs.starrocks.io/zh/docs/loading/Flink-connector-starrocks/#exactly-once)ã€‚                                                                                                                                                                                                   |
| sink.buffer-flush.max-bytes       | Long    | 94371840ï¼ˆ90MBï¼‰     | ç§¯æ”’åœ¨å†…å­˜çš„æ•°æ®å¤§å°ï¼Œè¾¾åˆ°è¯¥é˜ˆå€¼åæ•°æ®é€šè¿‡ Stream Load ä¸€æ¬¡æ€§å¯¼å…¥ StarRocksã€‚å–å€¼èŒƒå›´ï¼š[64MB, 10GB]ã€‚å°†æ­¤å‚æ•°è®¾ç½®ä¸ºè¾ƒå¤§çš„å€¼å¯ä»¥æé«˜å¯¼å…¥æ€§èƒ½ï¼Œä½†å¯èƒ½ä¼šå¢åŠ å¯¼å…¥å»¶è¿Ÿã€‚ è¯¥å‚æ•°åªåœ¨ `sink.semantic` ä¸º `at-least-once` æ‰ä¼šç”Ÿæ•ˆã€‚ `sink.semantic` ä¸º `exactly-once` ï¼Œåˆ™åªæœ‰ Flink checkpoint è§¦å‘æ—¶ flush å†…å­˜çš„æ•°æ®ï¼Œå› æ­¤è¯¥å‚æ•°ä¸ç”Ÿæ•ˆã€‚                                                                                                                     |
| sink.buffer-flush.max-rows        | Long    | 500000             | ç§¯æ”’åœ¨å†…å­˜çš„æ•°æ®æ¡æ•°ï¼Œè¾¾åˆ°è¯¥é˜ˆå€¼åæ•°æ®é€šè¿‡ Stream Load ä¸€æ¬¡æ€§å¯¼å…¥ StarRocksã€‚å–å€¼èŒƒå›´ï¼š[64000, 5000000]ã€‚è¯¥å‚æ•°åªåœ¨ `sink.version` ä¸º `V1`ï¼Œ`sink.semantic` ä¸º `at-least-once` æ‰ä¼šç”Ÿæ•ˆã€‚                                                                                                                                                                                                            |
| sink.max-retries                  | Integer | 3                  | Stream Load å¤±è´¥åçš„é‡è¯•æ¬¡æ•°ã€‚è¶…è¿‡è¯¥æ•°é‡ä¸Šé™ï¼Œåˆ™æ•°æ®å¯¼å…¥ä»»åŠ¡æŠ¥é”™ã€‚å–å€¼èŒƒå›´ï¼š[0, 10]ã€‚è¯¥å‚æ•°åªåœ¨ `sink.version` ä¸º `V1` æ‰ä¼šç”Ÿæ•ˆã€‚                                                                                                                                                                                                                                                                  |
| sink.connect.timeout-ms           | Integer | 30000              | ä¸ FE å»ºç«‹ HTTP è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚å–å€¼èŒƒå›´ï¼š[100, 60000]ã€‚                                                                                                                                                                                                                                                                                                                |
| sink.wait-for-continue.timeout-ms | Integer | 10000              | ç­‰å¾… FE HTTP 100-continue åº”ç­”çš„è¶…æ—¶æ—¶é—´ã€‚å–å€¼èŒƒå›´ï¼š[3000, 60000]ã€‚                                                                                                                                                                                                                                                                                                    |
| security.sensitive.keys           | String  | username; password | å®‰å…¨å±æ€§ï¼šåŒ…å«æ•æ„Ÿä¿¡æ¯çš„é”®ååˆ—è¡¨ <br>åœ¨è¾“å‡ºæ—¥å¿—æ—¶ï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«è„±æ•ã€‚ä½¿ç”¨ `;` åˆ†éš”å¤šä¸ªé”®åã€‚                                                                                                                                                                                                                                                                                                    |


## å‚è€ƒèµ„æ–™
- [ä» Apache FlinkÂ® æŒç»­å¯¼å…¥](https://docs.starrocks.io/zh/docs/loading/Flink-connector-starrocks/) Â· _StarRocks_
